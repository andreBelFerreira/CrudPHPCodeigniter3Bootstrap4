<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class M_retorno extends CI_Model
{
       ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////// RETORNA A TABELA PRINCIPAL                              /////////////////////////////
    ///////// CRIADO POR André Belmonte                                       /////////////////////////////
    ///////// 21/03/2022                                              /////////////////////////////
    ///////// Revisado:                                               /////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    public function retornoRegistroRefugo()
    {
        $this->db->where('status <>', 'D');
        $query = $this->db->get("anc");
        return $query->result();
    }

    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////           PROJETO  REGISTROS REFUGO, CONTROLLER "INT_PCPUSIN/REGISTROREFUGO"                 //////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////// RETORNAR TODOS OS NÚMEROS DOS ALMOXARIFADOS            //////////////////////////////
    ///////// CRIADO POR André Belmonte                                      //////////////////////////////
    ///////// 23/03/2022                                             //////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    public function BuscaNomeSecao()
    {
        $this->db->distinct();
        $this->db->select('local');
        $query = $this->db->get("defeitos");
        return $query->result();
    }

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ////////  RETORNAR ALMOXARIFADOS QUE JÁ FIZERAM RR               //////////////////////////////
    //////// CRIADO POR André Belmonte                                       //////////////////////////////
    //////// 23/03/2022                                              //////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    public function BuscaAlmoxOrig()
    {
        $query = $this->db->get("almoxarifados");
        $sql = $query->result();

        // // $sql = $db->query($sql);

        foreach ($sql as $linha) {
            $retorno[] = array(
                "almorig" => trim($linha->codalm),
                "descricao" => trim(strtoupper(utf8_encode($linha->descricao)))
            );
        }
        return ($retorno);
    }

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////// RETORNAR O NOME DO PRODUTO E A UNIDADE MEDIA           //////////////////////////////
    ///////// CRIADO POR André Belmonte                                      //////////////////////////////
    ///////// 24/02/2022                                             //////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    public function buscaNProduto($value)
    {

        // Verifica se a ID no banco de dados
        $this->db->where('registro', $value);
        //limita para apenas um regstro    
        $this->db->limit(1);
        //pega os produto
        $query = $this->db->get("produtos");
        //retornamos o produto
        return $query->result();

    }

    ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////// RETORNAR CODIGOS DE DEFEITO                            //////////////////////////////
    ///////// CRIADO POR André Belmonte                                      //////////////////////////////
    ///////// 24/02/2022                                             //////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    public function slLocalRef($value)
    {
        $this->db->select('ID_DEFEITOS,COD_DEFEITO,DESCRICAO');
        // $this->db->select('local', $value);
        $this->db->where('local', $value);
        $query = $this->db->get("defeitos");
        return $query->result();

        } 
        
        ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////// RETORNAR TODOS CENTRO DE CUSTO, CRIADO POR André Belmonte      //////////////////////////////
    ///////// CRIADO POR André Belmonte                                      //////////////////////////////
    ///////// 31/03/2022                                             //////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    public function ret_depto()
    {
        $this->db->select('CODCC,DESCRICAO');
        // $this->db->select('local', $value);
        $this->db->where('status <>', 'D');
        $query = $this->db->get("cecusto");
        return $query->result();

    }


    //////////////////////////////////////////////////////////////////////////////////////////
    ///// RETORNAR O TIPO DE CODIGO COM O NOME DO CODIGO  ////////////////////////////////////
    ///// CRIADO POR André Belmonte                ///////////////////////////////////////////////////
    ///// 03/10/2022                       ///////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////
    public function BuscLocalCod($cod)
    {
        $this->db->select('local,cod_defeito,descricao');
        $this->db->where('status <>', 'D');
        $this->db->where('cod_defeito', $cod);
        $query = $this->db->get("defeitos");
        return $query->result();

    }

      ///////////////////////////////////////////////////////////////////////////////////////////////
    ///////// RETORNA A TABELA PRINCIPAL                              /////////////////////////////
    ///////// CRIADO POR André Belmonte                                       /////////////////////////////
    ///////// 25/04/2022                                              /////////////////////////////
    ///////// Revisado:                                               /////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////////////////////
    public function btnEdit($id)
    {
        $this->db->where('status <>', 'D');
        $this->db->where('id', $id);
        $query = $this->db->get("anc");
        return $query->result();
    }
}
